-- #1 Insert CLIENT record
SELECT [CLIENTID], [CLIENTNAME]
FROM (
	VALUES ('SCA','SCA Property Group')
	--,('CLIENTID','CLIENTNAME')
) as c ([CLIENTID], [CLIENTNAME])
EXCEPT
SELECT [CLIENTID], [CLIENTNAME]
FROM [MRI_AUNZ].[dbo].[CLIENT];

-- #2 Insert PORT record
SELECT [PORTID],[DESCRPN],[CLIENTID]
FROM (
	VALUES('210000','SCA Property Group','SCA')
	--,('PORTID','DESCRPN','CLIENTID')
) as p ([PORTID],[DESCRPN],[CLIENTID])
EXCEPT
SELECT [PORTID],[DESCRPN],[CLIENTID]
FROM [MRI_AUNZ].[dbo].[PORT];

-- #3 Insert PROJ record
SELECT [PROJID],[PROJNAME],[PORTID]
FROM (
	VALUES('129001','SCA-NSW-RETAIL','210000')
	,('149001','SCA-QLD-RETAIL','210000')
	--,('PROJID','PROJNAME','PORTID')
) as p ([PROJID],[PROJNAME],[PORTID])
EXCEPT
SELECT [PROJID],[PROJNAME],[PORTID]
FROM [MRI_AUNZ].[dbo].[PROJ];

-- #4 Update ENTITY with new PROJID
WITH newPROJ AS (
	SELECT [ENTITYID], [PROJID]
	FROM (
		VALUES('121625','129001'),('121626','129001'),('121627','129001')
		,('121628','129001'),('121629','129001'),('141140','149001')
		,('141141','149001'),('141142','149001'),('141143','149001')
		,('141144','149001'),('141145','149001'),('141146','149001')
		,('141147','149001'),('141148','149001'),('141149','149001')
		,('141150','149001'),('141151','149001'),('141152','149001')
		,('141153','149001')
	) as p ([ENTITYID], [PROJID])
)
SELECT e.[ENTITYID], e.[PROJID], p.[PROJID]
FROM [MRI_AUNZ].[dbo].[ENTITY] e
	INNER JOIN [newPROJ] p ON e.[ENTITYID] = p.[ENTITYID]
WHERE e.[PROJID] <> p.[PROJID];
